<?xml version="1.0" encoding="UTF-8"?>
<Excel>
    <!-- 
        name:sheet页名称，与模板中相同
        dataRowNum：模板中数据行等于Excel的行号，从1开始
        dataStartNum:开始填充数据的行
        footerRowNum:模板中尾行的行号，Excel的行标号，从1开始
        class：处理此Sheet的类
        sum:本列需要合计则设置为true
     -->
    <Sheet name="R1-CHEM" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="R2-LCMS_Micro" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="R3-Hema_Flow" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="R4-Variant" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="R5-Oversea" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="R6-PCR" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="R7-Urine" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="R8-Cent_Immu_Liai_Mini" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="R9-Elisa" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="Lab_Gen_Supplier" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="CTM_Suppliers_DTW" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="Discard_CLab" dataRowNum="5" dataStartNum="5" footerRowNum="7" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="">opening</col>
        <col index="5" type="">invendor</col>
        <col index="6" type="">ininterlab</col>
        <col index="7" type="">insponsor</col>
        <col index="8" type="">incharges</col>
        <col index="9" type="">intotal</col>
        <col index="10" type="">outtrialtest</col>
        <col index="11" type="">outvalidation</col>
        <col index="12" type="">outdiscard</col>
        <col index="13" type="">outintellab</col>
        <col index="14" type="">outsponsor</col>
        <col index="15" type="">outother</col>
    </Sheet>
    <Sheet name="Validation_CLab" dataRowNum="4" dataStartNum="4" footerRowNum="7" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="">opening</col>
        <col index="5" type="">invendor</col>
        <col index="6" type="">ininterlab</col>
        <col index="7" type="">insponsor</col>
        <col index="8" type="">incharges</col>
        <col index="9" type="">intotal</col>
        <col index="10" type="">outtrialtest</col>
    </Sheet>
    <Sheet name="R10-Oncology" dataRowNum="9" dataStartNum="8" footerRowNum="10" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="" sum="true">opening</col>
        <col index="5" type="" sum="true">inVendor</col>
        <col index="6" type="" sum="true">inInterlab</col>
        <col index="7" type="" sum="true">inSponsor</col>
        <col index="8" type="" sum="true">inCharges</col>
        <col index="9" type="" sum="true">inTotal</col>
        <col index="10" type="" sum="true">outTrialTest</col>
        <col index="11" type="" sum="true">outValidation</col>
        <col index="12" type="" sum="true">outDiscard</col>
        <col index="13" type="" sum="true">outIntelLab</col>
        <col index="14" type="" sum="true">outSponsor</col>
        <col index="15" type="" sum="true">outOther</col>
        <col index="16" type="" sum="true">outTotal</col>
        <col index="17" type="" sum="true">closing</col>
        <col index="18" type="" >CNY</col>
        <col index="19" type="">USD</col>
        <col index="20" type="">SGD</col>
        <col index="21" type="">EUR</col>
        <col index="22" type="">GBP</col>
        <col index="23" type="">localprice</col>
        <col index="24" type="" sum="true">totalAmount</col>
        <col index="25" type="">remark</col>
        <col index="26" type="" sum="true">qtyIn</col>
        <col index="27" type="" sum="true">qtyOut</col>
        <col index="29" type="" sum="true">checkQty</col>
        <col index="30" type="" sum="true">checkAmt</col>
        <col index="32" type="" sum="true">pqtyIn</col>
        <col index="33" type="" sum="true">pqtyOut</col>
        <col index="35" type="" sum="true">cqtyIn</col>
        <col index="36" type="" sum="true">cqtyOut</col>
    </Sheet>
    <Sheet name="Discard_APLab" dataRowNum="5" dataStartNum="5" footerRowNum="7" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="">opening</col>
        <col index="5" type="">invendor</col>
        <col index="6" type="">ininterlab</col>
        <col index="7" type="">insponsor</col>
        <col index="8" type="">incharges</col>
        <col index="9" type="">intotal</col>
        <col index="10" type="">outtrialtest</col>
        <col index="11" type="">outvalidation</col>
        <col index="12" type="">outdiscard</col>
        <col index="13" type="">outintellab</col>
        <col index="14" type="">outsponsor</col>
        <col index="15" type="">outother</col>
    </Sheet>
    <Sheet name="Validation_APLab" dataRowNum="4" dataStartNum="4" footerRowNum="6" class="com.ims.report.excel.R1Sheet">
        <sql>
			SELECT a.id,a.catno,a.catname,a.batchno,a.machineNo,a.machineName,ifnull(a.total,0)+ifnull(o.outTotal,0)-ifnull(i.inTotal,0) opening,
			ifnull(i.inVendor,0) inVendor,ifnull(i.inCharges,0) inCharges,ifnull(i.inInterlab,0) inInterlab,ifnull(i.inSponsor,0) inSponsor, ifnull(i.inTotal,0) inTotal,
			ifnull(o.outDiscard,0) outDiscard,ifnull(o.outIntelLab,0) outIntelLab,ifnull(o.outOther,0) outOther,ifnull(o.outSponsor,0) outSponsor,ifnull(o.outTrialTest,0) outTrialTest,ifnull(o.outValidation,0) outValidation,ifnull(o.outTotal,0) outTotal,ifnull(a.total,0) closing,
			p.CNY,p.EUR,p.GBP,p.SGD,p.USD,ifnull(p.localprice,0) localprice,ifnull(a.total*p.localprice,0) totalAmount,null as remark,
			ifnull(i.inTotal*p.localprice,0) qtyIn,ifnull(o.outTotal*p.localprice,0) qtyOut,
			0 checkQty,0 checkAmt,
			0 pqtyIn,0 pqtyOut,
			ifnull(i.inTotal*p.localprice+0,0) cqtyIn,ifnull(o.outTotal*p.localprice+0,0) cqtyOut 
			from b_cat a LEFT JOIN
					(
							SELECT
								ifnull(vin.catid, 0) catid,
								SUM(vin.inVendor) inVendor,
								SUM(vin.inCharges) inCharges,
								SUM(vin.inInterlab) inInterlab,
								SUM(vin.inSponsor) inSponsor,
					      SUM(vin.inVendor) + SUM(vin.inCharges) + SUM(vin.inInterlab) + SUM(vin.inSponsor) inTotal
							FROM
								r_in_view vin
							WHERE
								vin.indate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)i
					on a.id = i.catid
					LEFT JOIN
					(
							SELECT
								ifnull(o.catid, 0) catid,
								SUM(o.outDiscard) outDiscard,
								SUM(o.outIntelLab) outIntelLab,
								SUM(outOther) outOther,
								SUM(o.outSponsor) outSponsor,
								SUM(o.outTrialTest)outTrialTest ,
								SUM(o.outValidation) outValidation,
					      SUM(o.outDiscard) + SUM(o.outIntelLab)+SUM(outOther)+SUM(o.outSponsor)+SUM(o.outTrialTest)+SUM(o.outValidation) outTotal
							FROM
								r_out_view o
							WHERE
								o.outdate BETWEEN DATE('2014-01-01')
							AND DATE('2015-01-01')
					)o on a.id=o.catid 
					LEFT JOIN r_price_view p ON a.id=p.catid
					where date('2014-01-01') != ? and date('2014-01-01') != ?  and date('2014-01-01') != ?  and date('2014-01-01') != ?  
			
        </sql>
        <col index="1" type="">catno</col>
        <col index="2" type=""></col>
        <col index="3" type="">catname</col>
        <col index="4" type="">opening</col>
        <col index="5" type="">invendor</col>
        <col index="6" type="">ininterlab</col>
        <col index="7" type="">insponsor</col>
        <col index="8" type="">incharges</col>
        <col index="9" type="">intotal</col>
    </Sheet>
   
</Excel>
