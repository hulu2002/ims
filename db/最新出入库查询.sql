SELECT b_in.id id, b_in.catName AS catName, b_in.catno AS catno, b_in.inDate AS builtdate, b_in.person AS person, b_in.num AS num, CONCAT( b_in.person, '入库', b_in.num, '个', b_in.catName, '(', b_in.batchNo, ')' ) description FROM b_in, b_var WHERE b_var.bizkey = 'newinout' AND DATEDIFF(CURDATE(), b_in.inDate) <= b_var.bizValue AND DATEDIFF(CURDATE(), b_in.inDate) >= 0 UNION ALL SELECT b_out.id AS id, b_out.catname AS catName, b_out.catno AS catno, b_out.outDate AS builtdate, b_out.person AS person, b_out.num AS num, CONCAT( b_out.person, '出库', b_out.num, '个', b_out.catName, '(', b_out.batchNo, ')' ) description FROM b_out, b_var WHERE b_var.bizkey = 'newinout' AND DATEDIFF(CURDATE(), b_out.outDate) <= b_var.bizValue AND DATEDIFF(CURDATE(), b_out.outDate) >= 0 ORDER BY builtdate DESC